# DP 050 - Azure로 SQL 워크로드 마이그레이션
# 랩 1 - Azure 아키텍처 관련 고려 사항

**예상 소요 시간**: 50분

**전제 조건**: 이 랩을 수행하기 위한 필수 단계는 없습니다.

**랩 파일**: 이 랩용 파일은 _Allfiles\Labfiles\Starter\DP-150.1_ 폴더에 있습니다.

## 랩 개요

학생들은 이 모듈에서 파악한 정보를 활용하여 데이터 플랫폼 현대화에 대해 이해한 내용, 그리고 조직에서 현대화 프로젝트를 진행해야 하는 이유 및 프로젝트 진행 방법을 대략적으로 시연합니다. 그리고 Azure로 이동하는 비용을 결정하는 방법도 알아보며, 작업 중인 환경 관련 정보도 수집합니다. 또한 마지막으로 지정된 시나리오에 사용할 데이터 플랫폼 현대화 전략을 결정합니다.

## 랩 목표
  
이 랩을 완료하면 다음과 같은 작업을 수행할 수 있습니다.

- 데이터 플랫폼 현대화 설명
- 마이그레이션 단계 제시
- 데이터 마이그레이션 기술 설명

## 시나리오
  
최근 AdventureWorks에 선임 데이터 엔지니어로 입사한 여러분은 컨설턴트 및 설계자들과 협력하여 조직의 기술 및 비즈니스 요구 사항을 충족하는 데이터 플랫폼 현대화 프로젝트를 시작하고자 합니다. 이를 위해 Azure로 마이그레이션할 때 발생하는 TCO(총 소유 비용)를 계산해야 합니다. 그런 다음 주니어 데이터 엔지니어에게 Azure로 마이그레이션할 SQL Server 관련 정보 수집을 요청합니다. 그 후에는 지정된 시나리오에 가장 적합한 마이그레이션 대상 Azure 데이터 플랫폼 기술을 선택합니다.

## 연습 1: 데이터 플랫폼 현대화 이해

이 랩에서는 Azure로 데이터베이스를 마이그레이션할 때 발생하는 비용을 계산합니다.

예상 소요 시간: 15분

이 연습의 주요 작업은 다음과 같습니다.

1. Microsoft TCO(총 소유 비용) 계산기 열기
1. 서버 기반 워크로드 정의
1. 스토리지 추가
1. 네트워킹 추가
1. 통화 조정
1. 전기 요금 조정
1. 기타 가정 값 조정
1. 온-프레미스의 비용과 Azure 비용 비교

### TCO(총 소유 비용) 계산기 열기

1. 브라우저를 열고 Azure TCO 계산기 +++https://azure.microsoft.com/pricing/tco/calculator/+++로 이동합니다.
1. **워크로드 정의** 아래 **서버** 섹션에서 기존 워크로드를 삭제합니다.

### 데이터베이스 워크로드 입력

1. **데이터베이스** 아래에서 기존 워크로드를 삭제합니다.
1. **+ 데이터베이스 추가** 를 선택합니다.
1. **이름** 텍스트 상자에 **Accounting**을 입력합니다.
1. **원본** 섹션에서 다음 값을 선택합니다.

    | 속성 | 값 |
    | --- | --- |
    | 데이터베이스 | Microsoft SQL Server |
    | 라이선스 | 엔터프라이즈 |
    | 환경 | 물리적 서버 |
    | 운영 체제 | Windows |
    | 운영 체제 라이선스 | 데이터 센터 |
    | 서버 | 1 |
    | 서버당 프로세서 수 | 1 |
    | 프로세서당 코어 수 | 4 |
    | RAM(GB) | 64 |
    | 옵티마이저 | CPU |
    | SQL Server 2008/2008R2 | 화면을 오른쪽으로 밉니다. |

1. **대상** 섹션에서 다음 값을 선택합니다.

    | 속성 | 값 |
    | --- | --- |
    | 서비스 | SQL Server VM |
    | 디스크 유형 | SSD |
    | IOPS | 5,000 |
    | SQL Server 스토리지 | 32GB |
    | SQL Server 백업 | 32GB |

    > [!참고]
    > Azure에서는 프로덕션 서버용으로 SSD를 사용하는 것이 좋습니다.

### 스토리지 및 네트워킹 워크로드 입력

1. **스토리지** 아래에서 기존 워크로드를 삭제하고 **+ 스토리지 추가** 를 선택합니다.
1. 다음 값을 입력합니다.

    | 속성 | 값 |
    | --- | --- |
    | 이름 | Accounting 로컬 디스크 |
    | 스토리지 유형 | 로컬 디스크/SAN |
    | 디스크 유형 | HDD |
    | 용량 | 3TB |
    | 백업 | 1TB |
    | 보관 | 0TB |

1. **네트워킹** 아래 **아웃바운드 대역폭** 컨트롤에서 **1GB**를 선택합니다.
1. 페이지 아래쪽에서 **다음**을 선택합니다.

### 가정 값 조정

1. **가정 값 조정** 섹션의 **통화** 목록에서 기본 설정 통화를 선택합니다.
1. **Software Assurance 혜택 범위(Azure 하이브리드 혜택 제공)** 아래에서 **Windows Server Software Assurace 혜택 범위** 슬라이더를 오른쪽으로 밉니다.
1. **SQL Server Software Assurance 혜택 범위** 슬라이더를 오른쪽으로 밉니다.

    > [!참고]
    > **Software Assurance** 섹션의 링크를 클릭하면 사용 가능한 Software Assurance에 대해 자세히 알아볼 수 있습니다. 후속 섹션에도 비슷한 링크가 있습니다.

1. **GRS(지역 중복 스토리지)** 아래에서 **GRS는 주 지역에서 매우 멀리 떨어진 보조 지역에 데이터를 복제합니다**. 옆의 토글이 꺼져 있는지 확인합니다.
1. **가상 머신 비용** 아래에서 **계산기가 B 시리즈 가상 머신을 추천하지 않도록 설정** 옆의 토글이 꺼져 있는지 확인합니다.
1. **전기 요금** 아래의 **KW당 가격(시간)** 텍스트 상자에 해당 지역의 실제 전기 요금 값을 입력합니다.

    > [!참고]
    > [전 세계 전기 요금](https://www.statista.com/statistics/263492/electricity-prices-in-selected-countries/)에서 대략적인 전기 요금을 확인할 수 있습니다. 이 페이지에 표시되는 요금은 USD($) 단위이므로 기본 설정 통화의 대략적인 값으로 변환하세요.

1. **스토리지 비용** 아래 값은 모두 기본값으로 유지합니다.
1. **IT 작업 비용** 아래 값은 모두 기본값으로 유지합니다.
1. **기타 가정 값** 아래에서 각 섹션을 확장하고 관련 비용을 살펴봅니다.
1. 페이지 아래쪽에서 **다음**을 선택합니다.

### 5개년 보고서 조사

1. **보고서 보기** 페이지에서 **시간 범위**는 기본값인 **5년**으로 설정되어 있습니다.
1. 아래쪽으로 스크롤하여 보고서를 표시한 다음 온-프레미스 시스템과 Azure의 예상 비용 비교 정보를 확인하고 다음 정보를 적어 둡니다.

    - 온-프레미스 워크로드에서 비용이 가장 많이 발생하는 영역
    - Azure로의 마이그레이션을 결정하면 비용을 가장 많이 절약할 수 있는 영역

1. 각 섹션을 차례로 확장하여 비용 내역을 조사합니다.
1. 현재 위치, 네트워크 대기 시간 또는 데이터 주권 요구 사항에 따라 지역을 변경하여 비용 차이를 살펴봅니다.

### 3개년 보고서 조사

1. 페이지 위쪽으로 스크롤하여 **시간 범위** 텍스트 상자에서 **3년**을 선택합니다.
1. 보고서 아래쪽으로 스크롤하여 온-프레미스 시스템과 Azure의 예상 비용 내역을 조사하고 다음 정보를 적어 둡니다.

    - 온-프레미스에서 비용이 가장 많이 발생하는 영역을 조사합니다.
    - Azure로의 마이그레이션을 결정하면 비용을 가장 많이 절약할 수 있는 영역

1. 각 섹션을 차례로 확장하여 비용 내역을 조사합니다.

이 연습에서는 Azure TCO 계산기를 사용하여 AdventureWorks Corporation의 회계 서버 및 관련 데이터베이스를 온-프레미스에 배포할 때와 Azure에 배포할 때의 비용 차이를 확인했습니다.

## 연습 2: 마이그레이션 단계 이해

이 작업에서는 기존 서버 사양을 살펴봅니다.

예상 소요 시간: 15분

이 연습의 주요 작업은 다음과 같습니다.

1. 기존 서버에서 사용하는 메모리의 양 파악
1. 기존 서버의 CPU 유형 검색
1. 기존 서버의 디스크 구성 확인

### 서버에서 사용 중인 메모리의 양 확인

1. 수업용으로 실행 중인 **LON-DEV-01** 가상 머신에 로그인합니다. 사용자 이름은 **administrator**이고 암호는 **Pa55w.rd**입니다.
1. 원하는 방법으로 서버에서 사용 중인 메모리의 양을 확인합니다.

    > **팁**: Windows의 모든 최신 버전에 포함되어 있는 애플리케이션인 시스템 정보를 사용하면 서버 또는 데스크톱 디바이스 관련 사양을 확인할 수 있습니다. 시스템 정보를 열려면 시작을 선택하고 검색 필드에 시스템 정보를 입력합니다.

1. 메모장에 값을 입력해 둡니다.

### 서버에서 사용 중인 CPU의 양 확인

1. 원하는 방법으로 서버에서 CPU 리소스를 사용하는 방식을 확인합니다.
1. 관찰한 내용을 메모장에 입력해 둡니다.

### 서버에서 사용 중인 디스크 구성 확인

1. 원하는 방법으로 서버에 구성되어 있는 디스크 구성을 확인합니다.
1. 메모장에 구성을 입력해 둡니다.
1. 메모장 파일의 이름을 ServerSpecs.txt로 지정하여 _Allfiles\Labfiles\Starter\DP-150.1_ 폴더에 저장합니다.

이 연습에서는 서버의 하드웨어 사양 관련 정보를 수집했습니다.

## 연습 3: 데이터 마이그레이션 기술

이 연습에서는 고객이 온-프레미스 SQL Server를 Azure로 마이그레이션할 수 있도록 데이터 플랫폼 기술을 선택합니다.

예상 소요 시간: 15분

이 연습의 주요 작업은 다음과 같습니다.

1. 시나리오 A에서 마이그레이션을 쉽게 수행하려면 필요한 데이터베이스 기술 파악
1. 시나리오 B에서 마이그레이션을 쉽게 수행하려면 필요한 데이터베이스 기술 파악

### 시나리오 A에서 마이그레이션을 쉽게 수행하려면 필요한 데이터베이스 기술 파악

1. 다음 시나리오를 살펴보세요.

      고객의 애플리케이션이 현재 온-프레미스 버전 Microsoft SQL Server 2008 내에 있는 여러 데이터베이스를 사용하고 있습니다. 총 데이터베이스 공간은 12TB로 큰 편이며, 매년 몇 TB씩 빠르게 증가하고 있습니다. 또한 애플리케이션은 보고 기능 사용을 위해 SQL Server Reporting Services와도 긴밀하게 통합되어 있습니다. 데이터베이스가 포함되어 있는 기존 SAN 스토리지는 용량이 거의 다 찼지만 확장하려면 비용이 많이 들며, 사용 기간 종료 시점도 얼마 남지 않았습니다. 해당 애플리케이션은 회사의 업무상 반드시 필요하고, 트랜잭션 속도는 보통 정도이며, 가동 중지 시간이 발생하면 업무상 큰 영향을 줍니다. 짧은 유지 관리 기간 동안 애플리케이션 가용성을 최대화하기 위한 변경을 수행할 수는 있습니다. 데이터베이스 크기가 빠르게 커지고 있어 DBA와 시스템 관리자가 모든 데이터베이스를 정상 상태로 유지하는 데 시간이 갈수록 오래 걸리고 있습니다.

1. 이 시나리오에는 어떤 데이터베이스 플랫폼 기술이 적합할까요?

### 시나리오 B에서 마이그레이션을 쉽게 수행하려면 필요한 데이터베이스 기술 파악

1. 다음 시나리오를 살펴보세요.

      쿼드 코어 SQL Server(16GB 메모리)의 데이터베이스에 부서 데이터를 보관하는 고객이 있습니다. 이 서버는 스프레드시트 및 Access 양식용 데이터에 간편하게 액세스할 수 있도록 백 엔드로 사용됩니다. 데이터베이스는 총 6개이며, 스토리지에서 데이터베이스가 차지하는 공간은 350MB입니다. 이 서버에 대해 가능한 최대 동시 연결 수는 12개입니다.

1. 이 시나리오에는 어떤 데이터베이스 플랫폼 기술이 적합할까요?

이 연습에서는 마이그레이션 프로젝트에 적합한 Azure 데이터베이스 기술을 파악했습니다.

## 랩 검토

45분 정도가 지나면 강사가 이 랩을 종료합니다. 그러면 전체 수강생들이 각 그룹에서 확인한 사항을 발표합니다.